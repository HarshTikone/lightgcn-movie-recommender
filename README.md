# ğŸ¬ LightGCN Movie Recommendation System (GNN)

> **An end-to-end, graph-based movie recommender built using LightGCN, designed to be explainable, interactive, and recruiter-ready.**

This project implements a **Light Graph Convolutional Network (LightGCN)** on the MovieLens dataset to generate personalized movie recommendations. It goes beyond a simple model by providing a **Streamlit-based interactive demo**, **graph visualizations**, **training dashboards**, and **explainability of recommendations**.

---

## ğŸ¥ Demo Video

â–¶ï¸ **Full Project Walkthrough (Recommended):**
[https://youtu.be/REPLACE_WITH_YOUR_DEMO_LINK](https://youtu.be/REPLACE_WITH_YOUR_DEMO_LINK)

**What the demo shows:**

* How userâ€“movie interactions form a graph
* How LightGCN propagates information over the graph
* Live recommendations with score breakdown
* Graph visualizations and embedding insights
* Model training and evaluation metrics

> ğŸ“Œ *Recruiters:* Watching the demo is the fastest way to understand the system end-to-end.

---

## ğŸš€ Project Overview

Traditional recommender systems struggle to capture higher-order userâ€“item relationships. This project models recommendations as a **bipartite graph** and applies **Graph Neural Networks (GNNs)** to learn powerful user and movie embeddings.

**Key idea:**
Users and movies are nodes, ratings are edges, and recommendations are generated by propagating information across the graph.

---

## ğŸ§  Model: LightGCN

LightGCN is a simplified but highly effective GNN for collaborative filtering:

* No nonlinearities or feature transformations
* Pure neighborhood aggregation
* Embeddings propagated across multiple graph layers
* Final embedding = mean of all layer embeddings

Mathematically:

```
E(k+1) = D^-1/2 Â· A Â· D^-1/2 Â· E(k)
```

This design improves both **performance** and **training efficiency**.

---

## ğŸ–¥ï¸ Interactive Streamlit Application

The project includes a **multi-tab Streamlit app** (`app.py`) that makes the system easy to explore:

### ğŸ§­ Start Here (GNN Explained)

* Step-by-step explanation of how ratings become a graph
* Visualization of userâ€“movie subgraphs
* Explanation of message passing and normalization

### ğŸ¯ Recommendations

* Select any user from MovieLens
* Generate Top-K personalized recommendations
* View score breakdown:

  * Graph (LightGCN) score
  * Tag similarity score
  * Final hybrid score
* Optional movie posters via TMDB API

### âš™ï¸ Train Model

* Train LightGCN from scratch
* Tune embedding size, layers, epochs, batch size
* Live loss and ranking metrics (Hit@K, Recall@K, NDCG@K)
* Saves checkpoint for reuse

### ğŸ§  Insights

* PCA visualization of learned movie embeddings
* Tag frequency and semantic patterns
* Tag suggestions from nearest neighbors in embedding space

---

## ğŸ“Š Evaluation

The model is evaluated using **ranking-based metrics** on held-out interactions:

* **Hit@K**
* **Recall@K**
* **NDCG@K**

Evaluation follows a sampled leave-one-out strategy, providing a realistic measure of recommendation quality.

---

## ğŸ› ï¸ Tech Stack

**Machine Learning & Graphs**

* PyTorch
* LightGCN (Graph Neural Network)
* Sparse adjacency matrices

**Data & Features**

* MovieLens dataset
* Tag cleaning and filtering
* Bag-of-words tag features

**Frontend & Visualization**

* Streamlit
* NetworkX (graph visualization)
* Matplotlib / PCA

---

## ğŸ“ Project Structure

```
lightgcn-movie-recommender/
â”‚
â”œâ”€â”€ app.py                 # Streamlit application
â”œâ”€â”€ data_preparation.py    # Data loading, graph building, tag cleaning
â”œâ”€â”€ model_training.py      # LightGCN model + BPR training
â”œâ”€â”€ prediction.py          # Recommendation & explainability logic
â”œâ”€â”€ ml-latest-small/       # MovieLens dataset
â”œâ”€â”€ lightgcn_checkpoint.pth# Trained model (generated)
â”œâ”€â”€ default.png            # Fallback poster image
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## â–¶ï¸ How to Run Locally

```bash
# Create virtual environment
python -m venv .venv
.venv\Scripts\activate   # Windows

# Install dependencies
pip install -r requirements.txt

# (Optional) Add TMDB API key for posters
setx TMDB_API_KEY your_key_here

# Run the app
streamlit run app.py
```

---

## ğŸ” Explainability & Engineering Depth

This project demonstrates:

* Clear understanding of **graph-based recommendation systems**
* Ability to implement **research-grade models (LightGCN)**
* Strong ML engineering practices: training, evaluation, visualization
* Focus on **explainability**, not just accuracy
* End-to-end system thinking from data â†’ model â†’ UI

---

## ğŸ“Œ Future Improvements

* Temporal dynamics in user behavior
* Graph attention or hybrid GNN models
* Large-scale training on full MovieLens-25M
* Deployment as a backend API

---

**Author:** Harsh Tikone
**Focus:** Machine Learning, Graph Neural Networks, Recommender Systems
